@using CUSrinagar.Extensions
@using CUSrinagar.Enums
@using CUSrinagar.Models
@model List<Transcript>
@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Transcript</title>
    <style type="text/css">
        .line-height {
            line-height: 4.4mm;
        }

        @@media print {
            .noneOnPrint {
                display: none;
            }
        }
        .background {
            position: absolute;
            top: 0%;
            left: 3%;
            z-index: 0;
            background: white;
            display: block;
            opacity: 0.35;
        }

        .bg-text {
            color: lightgray;
            font-size: 40px;
        }

    </style>
    <link href="~/Content/ThemePublic/Libraries/css/printer-frndly.css" rel="stylesheet" type="text/css" />

</head>
<body style="background: #e0e0e0;margin: auto;vertical-align: middle;display: table;">
    @if (Model.IsNotNullOrEmpty())
    {
        foreach (var transcript in Model)
        {
            if (transcript != null && transcript.Subject.IsNotNullOrEmpty() && transcript.SGPA.IsNotNullOrEmpty() && transcript.CGPA.IsNotNullOrEmpty() && transcript.Subject.All(x => x.GradePoints > 0))
            {
                var lineHeight = (Math.Round(200 / (transcript.Subject.Count * 1.74), 1) - 0.1).ToString("n1") + "mm";
                <section style="size:A4;background: white;padding:0;margin: 0;overflow: hidden;box-sizing: border-box;width: 210mm;height: 297mm;position:relative;page-break-after: always;"> 
                    <div class="background">
                        <p class="bg-text">
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                            Provisional Transcript Provisional Transcript<br />
                        </p>
                    </div>
                        <table style="margin-top:2mm;">
                            <tbody>
                                <tr>
                                    <td style="text-align:left;">
                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="~/Content/ThemePublic/PrintImages/MarksSheetLogo.png" style="width:60px;margin-top:-25px;" />
                                    </td>
                                    <td style="text-align:center;">
                                        <div style="margin-right:16px;">
                                            <div class="wordart slate">
                                                <span class="text">
                                                    &nbsp;&nbsp;Cluster University Srinagar
                                                </span>
                                            </div>
                                            <h4 class="text-success no-margin-bottom" style="margin-top:2mm;">Provisional Transcript of Academic Record</h4>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                    <div style="margin:0mm;margin-right: 6.5mm;margin-left: 6.5mm;margin-top:2.5mm;font-family: monospace;">

                        <hr style="margin:0mm;margin-top:0.3mm;margin-bottom: 0mm;" />

                        <!--Header General Info Section Begins-->
                        <table border="0" style="line-height: 4mm;">
                            <tbody style="text-align: left;">
                                <tr>
                                    <td style="width: 20mm;">Name:</td>
                                    <td style="width: 100mm;font-weight: bold;">@transcript.FullName.ToUpper()</td>
                                    <td style="width: 50mm;">Registration No:</td>
                                    <td style="width: 45mm;font-weight: bold;">@transcript.CUSRegistrationNo.ToUpper().Trim()</td>
                                </tr>
                                <tr>
                                    <td style="">Father:</td>
                                    <td style="font-weight: bold;">@transcript.FathersName.ToUpper()</td>
                                    <td style="">Exam Roll No:</td>
                                    <td style="font-weight: bold;">@transcript.ExamRollNumber</td>
                                </tr>
                                <tr>
                                    <td style="">Programme:</td>
                                    <td style="font-weight: bold;">@transcript.CourseFullName.ToUpper()</td>
                                    <td style="">Batch:</td>
                                    <td style="font-weight: bold;">@transcript.Batch</td>
                                </tr>
                                <tr>
                                    <td style="">College:<br />   &nbsp;</td>
                                    <td style="font-weight: bold;">
                                        @transcript.CollegeFullName.ToUpper()
                                        <br />
                                        <small>@transcript.CollegeAddress.ToUpper()</small>
                                    </td>
                                    <td style="">
                                        Mode:<br />
                                        Medium of Instruction:
                                    </td>
                                    <td style="font-weight: bold;">Regular<br />English</td>
                                </tr>
                            </tbody>
                        </table>
                        <!---Header General Info Section Ends-->
                        <!--Subject Section Begins-->
                        <table border="1" class="line-height" style="line-height:@lineHeight;border-collapse: collapse;border: 0.1mm solid;border-color: lightgray;width: 197mm;display: inline-table;">
                            <tbody>
                                <tr>
                                    <th style="padding:0mm;">Course</th>
                                    <th style="padding:0mm;"><small>Credit</small></th>
                                    <th style="padding:0mm;vertical-align: middle;text-align:center;width:15mm;"><small>Grade Letter</small></th>
                                    <th style="padding:0mm;vertical-align: middle;text-align:center;width:15mm;"><small>Grade Points</small></th>
                                    <th style="padding:0mm;vertical-align: middle;text-align:center;width:15mm;"><small>Credit Points</small></th>
                                    <th><small>SGPA</small></th>
                                </tr>
                                @{
                                    var Semesters = transcript.SGPA.Select(x => x.Semester).Distinct().OrderBy(x => x)?.ToList();

                                    if (Semesters.IsNotNullOrEmpty())
                                    {
                                        for (int Semester = 1; Semester <= Semesters.Count; Semester++)
                                        {
                                            <tr>
                                                <th style="text-align: left;padding-left: 10px;vertical-align: middle;border: 0.1mm solid slategray;" colspan="6">@(CUSrinagar.Extensions.Helper.GetEnumDescription((Semester)(Semester))) </th>
                                            </tr>
                                            var _SGPATypes = transcript.SGPA.Where(x => x.Semester == Semester)?.ToList();
                                            if (_SGPATypes.IsNotNullOrEmpty())
                                            {
                                                foreach (var _SGPAType in _SGPATypes.OrderBy(x => x.SGPAType).ToList())
                                                {
                                                    var _Subjects = transcript.Subject.Where(x => x.Semester == Semester && x.SGPAType == _SGPAType.SGPAType).ToList();
                                                    if (_Subjects.IsNotNullOrEmpty())
                                                    {
                                                        _Subjects = (from m in _Subjects orderby m.SubjectType.ToString(), m.SubjectTitle select m).ToList();
                                                        foreach (var item in _Subjects)
                                                        {
                                                            string code = CUSrinagar.DataManagers.GeneralFunctions.GetSubjectTypeCode(item.SubjectType);
                                                            <tr style="">
                                                                <td style="text-align: left;padding-left: 10px;vertical-align: middle;">
                                                                    <span>@item.SubjectTitle.ToUpper().Trim()</span> @(string.IsNullOrEmpty(code) ? "" : "(" + code.ToUpper() + ")")
                                                                </td>
                                                                <td style="vertical-align: middle;text-align:center;">@item.Credit</td>
                                                                <td style="vertical-align: middle;padding-left:6mm">@item.GradeLetter.ToUpper()</td>
                                                                <td style="vertical-align: middle;text-align:center;">@item.GradePoints</td>
                                                                <td style="vertical-align: middle;text-align:center;">@(item.Credit * item.GradePoints)</td>
                                                                <td style="vertical-align: middle;text-align:center;"></td>
                                                            </tr>
                                                        }
                                                    }
                                                    <tr>
                                                        <th title="Total" style="text-align:center;border: 0.1mm solid slategray;">Total</th>
                                                        <th title="Total Credit" style="text-align:center;border: 0.1mm solid slategray;">@_SGPAType.Credits</th>
                                                        <th colspan="2" style="border: 0.1mm solid slategray;"></th>
                                                        <th title="Total Credit Points" style="text-align:center;border: 0.1mm solid slategray;">@_SGPAType.CreditPoints</th>
                                                        <th title="SGPA" style="text-align:center;border: 0.1mm solid slategray;">@_SGPAType.SGPA</th>
                                                    </tr>
                                                }
                                            }
                                        }
                                    }
                                }
                            </tbody>
                        </table>
                        <!--Subject Section Ends-->
                        <!---Footer Points Section Begins-->
                        <table border="0" style="margin-top: 1mm;line-height: 4mm;">
                            <tbody>
                                @if (transcript.CGPA.IsNotNullOrEmpty())
                                {
                                    foreach (var item in transcript.CGPA.OrderBy(x => x.SGPAType).ToList())
                                    {
                                        <tr>
                                            <td style="width: 100mm;">
                                                Total Credits Earned: <b> @item.TotalCreditsEarned</b>
                                            </td>
                                            <td style="width: 120mm;">
                                                Total Credit Points: <b> @item.TotalCreditPoints</b>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width: 100mm;">
                                                Commulative Grade Point Average(CGPA): <b> @item.CGPA</b>
                                            </td>
                                            <td style="width: 120mm;">
                                                Percentage Equivalent: <b>@item.Percentage</b>
                                            </td>
                                        </tr>
                                    }
                                }
                                <tr>
                                    <td style="width: 100mm;">
                                        Date of Passing: <b>
                                            @if (@transcript.CGPA.FirstOrDefault().DateofDeclaration == null)
                                            {<span></span>}
                                            else
                                            {<span>@transcript.CGPA.FirstOrDefault().DateofDeclaration.ToString("dd-MMM-yyyy")</span>}
                                        </b>
                                    </td>
                                    <td style="width: 120mm;">
                                        Notification No.: <b> @transcript.CGPA.FirstOrDefault().NotificationNo.ToUpper()</b>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!---Footer Points Section Ends-->
                    </div>
                </section>
            }
        }
    }
    else
    {
        <section class="sheet padding-5mm">
            <p>Transcript Not Generated .... </p>
        </section>
    }

    <script src="~/Content/ThemeAdmin/Content/Scripts/Libraries/jquery-3.2.1.min.js"></script>
    <script src="~/Scripts/General/general.js"></script>
    <script src="~/Scripts/Pages/admin-transcript.js"></script>
</body>
</html>


