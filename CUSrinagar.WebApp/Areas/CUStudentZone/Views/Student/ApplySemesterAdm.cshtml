@using CUSrinagar.Models
@using CUSrinagar.Extensions

@model ARGPersonalInformation

@{
    ViewBag.Title = $"Semester-{ViewBag.AdmSemester} Admission Form";
    ADMSemesterAdmissionSettings _SemesterSettings = (ADMSemesterAdmissionSettings)ViewBag.SemesterSettings;
}
@section CUSSitemap{
    <ul class="breadcrumb">
        <li>
            <i class="ace-icon fa fa-home home-icon"></i>
            <a href="@Url.Action("Index","Dashboard",new { area="CUStudentZone"})">Home</a>
        </li>
        <li>
            <a href="#" class="active">Semester Admission Form</a>
        </li>
    </ul>
}
<div class="page-header">
    <br />
</div>
@if ((short)ViewBag.AdmSemester != 0 && ViewBag.IsBatchAllowed == true)
{
    <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-7" style="border:2px solid #cacaca;border-radius:6px;">
            <div class="row panel panel-body">
                <div id="response">
                    <strong>
                        @if (TempData["response"] != null)
                        {
                            @Html.Raw(TempData["response"])
                        }
                    </strong>
                </div>
                <h1 class="text-center">
                    <i class="fa fa-credit-card"></i> Semester-@ViewBag.AdmSemester &amp; @(ViewBag.AdmSemester + 1) Admission Form - @DateTime.UtcNow.Year
                </h1>
                <div class="" style="background-color:white;">
                    <div class="table-bordered" style="margin:20px;font-size:18px">
                        <table class="table">
                            <tbody>
                                <tr>
                                    <td class="col-md-9">Full Name : <b> @Model.FullName</b></td>
                                </tr>
                                <tr>
                                    <td>CUS Registration No. : <b> @Model.CUSRegistrationNo</b></td>
                                </tr>
                                <tr>
                                    <td>Course Name : <b> @ViewBag.CourseFullName</b></td>
                                </tr>
                                <tr>
                                    <td>Current Semester : <b> @Model.CurrentSemesterOrYear</b></td>
                                </tr>
                                @if (ViewBag.isSelfFinance)
                                {
                                    <tr>
                                        <td>Selected Under : <b> Self-Financed</b></td>
                                    </tr>
                                }
                                <tr>
                                    <td class="text-right">
                                        <p>
                                            @if (Model.PaymentDetail.IsNullOrEmpty())
                                            {
                                                <strong style="color:red">Total University Admisson Fee to Pay (Rs) : @_SemesterSettings.AdmissionFee</strong>
                                            }
                                            else
                                            {
                                                <strong style="color:#088e38">
                                                    Total University Admisson Fee (Rs) Paid: @Model.PaymentDetail[0].TxnAmount<br />
                                                    TxnReference No. : @Model.PaymentDetail[0].TxnReferenceNo<br />
                                                    Dated : @Model.PaymentDetail[0].TxnDate.ToShortDateString()<br />
                                                </strong>
                                            }
                                        </p>
                                    </td>
                                </tr>
                                <tr>
                                    <th style="color:#2359ef">1. In-case Amount is not deducted try to enable E-COM in your card using your bank App or ATM like M-Pay, or try to use other methods of online banking.</th>
                                </tr>
                                <tr>
                                    <th style="color:#2359ef">2. College component Fee is to be deposited in the respective college.</th>
                                </tr>
                                <tr>
                                    <th style="color:#2359ef">3. If you have already submitted Fee and you are still unable to print your Semester Admission Form visit Cluster University I.T Section.</th>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <br />
                </div>

                <div class="clearfix hidden-print"></div>
            </div>

            @using (Html.BeginForm("ApplySemesterAdm", "Student", FormMethod.Post, new { area = "CUStudentZone", @class = "rnd5", @id = "frmSemAdmFrm" }))
            {
                @Html.AntiForgeryToken()
                <p class="text-center">
                    <input type="hidden" name="command" value="" id="JsClicked" />
                    <input type="hidden" value="@ViewBag.AdmissionFee" name="ADMFee" />
                    <span id="hideButtons6">
                        @if (Model.PaymentDetail.IsNullOrEmpty())
                        {
                            if (_SemesterSettings.Status)
                            {
                                <button type="submit" id="jsPayFee" class="btn btn-success"><i class="fa fa-money"></i> Apply &amp; Pay University Fee </button>
                            }
                            <text> &nbsp; &nbsp; &nbsp;</text>

                            //if (ViewBag.AdmSemester > 4)
                            //{
                            <button type="button" href="javascript:void(0);" class="btn btn-success" disabled><i class="fa fa-check"></i> Print Form</button>
                            @*}
                                else
                                {
                                    <button type="button" href="javascript:void(0);" class="btn btn-success" disabled><i class="fa fa-check"></i> Select New Combination</button>
                                }*@
                        }
                        else
                        {
                            if (_SemesterSettings.Status)
                            {
                                <button type="button" id="jsPayFee" class="btn btn-success" disabled><i class="fa fa-money"></i> Apply &amp; Pay University Fee</button>
                            }
                            <text>&nbsp;&nbsp;&nbsp;</text>
                            //if (ViewBag.AdmSemester > 4)
                            //{
                            <a href="@Url.Action("SemesterAdmForm", "Student", new { S = ((int)ViewBag.AdmSemester).ToString().EncryptCookieAndURLSafe(), area = "CUStudentZone" })" class="btn btn-success"><i class="fa fa-check"></i> Print Form</a>
                            @*}
                                else
                                {
                                    <a href="@Url.Action("GetCombination", "Combination", new { semester = ((int)ViewBag.AdmSemester).ToString(), area = "CUStudentZone" })" class="btn btn-success"><i class="fa fa-check"></i> Select New Combination</a>
                                }*@
                        }

                    </span>
                </p>
            }
        </div>
        <div class="col-md-3"></div>

        <div class="col-lg-12"><br /><br /><br /><br /></div>
    </div>
}
else
{
    if (!ViewBag.IsBatchAllowed)
    {
        <h3 style="color:red;text-align:center">
            Your Batch/Current Semester is not allowed in this semester admission.<br /><br /><span style="color:green">Indeed you can reprint your already applied forms below.</span>
        </h3>
    }
    else
    {
        <h3 style="color:red;text-align:center">
            The process of applying Semester Admission Form for @ViewBag.CourseFullName is either closed or will be allowed soon.<br /><br /><span style="color:green">Indeed you can reprint your already applied form below.</span>
        </h3>
    }
    <div class="col-sm-12 center">
        <div class="col-sm-3"></div>
        <div class="col-sm-6 center">
            <div class="well well-sm">
                <div class="row">
                    <div class="col-sm-12">
                        @using (Html.BeginForm("SemesterAdmForm", "Student", FormMethod.Get, new { @class = "jsMainForm", @area = "CUStudentZone", @id = "print" }))
                        {
                            <div class="form-group">
                                <h5><b> Re-Print Semester Admission Form  </b> </h5>
                                <hr class="no-padding no-margin" />
                            </div>
                            <div class="form-group col-sm-12">
                                <select class="form-control" name="S" required>
                                    <option value="">choose semester</option>
                                    @for (int i = 1; i <= (Model?.CurrentSemesterOrYear ?? 0) + 2; i = i + 2)
                                    {
                                        <option value="@(i.ToString().EncryptCookieAndURLSafe())">Semester-@i &amp; @(i+1)</option>
                                    }
                                </select>
                            </div>

                            <div class="form-group col-sm-12">
                                <button type="submit" class="btn btn-primary pull-right">
                                    <i class="fa fa-download"></i> Re-Print
                                </button>
                            </div>

                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
}

@section PageSpecificJSFiles
    {
    <script src="@Url.Content("~/Content/ThemeAdmin/Content/Scripts/JSAdmission/SemesterAdmission.js")"></script>
    <script type="text/javascript">
        $("#StudentSection").removeClass("active");
        $("#ApplySemesterAdmSection").addClass("active");
    </script>
}

@section PageSpecificStyle{
    <style>
        .field-validation-error {
            color: red !important;
        }
    </style>
}
