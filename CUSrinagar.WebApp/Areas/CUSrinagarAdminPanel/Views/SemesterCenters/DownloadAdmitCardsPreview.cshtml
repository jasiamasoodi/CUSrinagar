@model List<CUSrinagar.Models.AttendanceSheetForm>
@using Nut
@using CUSrinagar.Extensions
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">
<head>
    @if (Model.IsNotNullOrEmpty())
    {
        if (Model.GroupBy(x => x.Course_ID).Count() <= 1)
        {
            <title>Admit Cards_Sem-@Model[0].Semester _@Model[0].CourseFullName.Replace("/", "").Replace("'", "")</title>
        }
        else
        {

            <title>Admit Cards_Sem-@Model[0].Semester _ALL_Courses</title>
        }
    }
    else
    {
        <title>No Admit Cards - CUSrinagar</title>
    }
    <style type="text/css">
        .btn-theme {
            background: #011c27;
            border: 1px solid #84aac9;
            color: #fff;
        }

            .btn-theme:hover {
                background: #545677;
                border: 1px solid #84aac9;
                color: #fff;
            }

        .QRCode {
            width: 95px;
            position: absolute;
            margin-top: -60px;
            margin-left: 0
        }

        @@media print {
            .IsPrintbody {
                display: none;
            }

            .QRCode {
                width: 95px;
                position: absolute;
                margin-top: -60px;
                margin-left: 0
            }

            .noneOnPrint {
                display: none;
            }

            .parentdiv {
                margin: 0 auto;
                width: 909px;
                padding: 0px;
            }
        }

        .parentdiv {
            margin: 0 auto;
            width: 909px;
            padding: 10px;
        }

        .dontbreakInside {
            page-break-inside: avoid;
        }

        .breakpagehere {
            page-break-after: always !important;
        }

        .blankspace {
            height: 350px !important;
        }


        .breakpagehere {
            height: 10px;
            background-color: grey !important;
        }

        table tr td {
            padding: 10px 10px;
        }

        table tr td, table tr th {
            max-width: 150px;
            word-wrap: hyphenate !important;
        }

        .ctable tr td {
            padding: 19px;
        }

        table tr td, table tr th {
            max-width: 150px;
            word-wrap: break-word !important;
        }

        table, table tr, table tr td, table tr th {
            border: 1px solid black;
            border-collapse: collapse;
        }

        table {
            width: 100%;
        }

        div {
            background-color: #fff;
        }

        .center {
            text-align: center !important;
        }

        .pull-right {
            float: right !important;
        }

        .pull-left {
            float: left !important;
        }
    </style>
</head>
<body style="background-color:grey" class="IsPrintbody">
    <div id="Jspleasewait" style="position:fixed;background-color:rgba(0, 0, 0, 0.20);left:0;top:0;z-index:200;width:100%;height:100%">
        <p style="font-size:30px;font-weight:bold;color:red;margin-top:20%;margin-left:41%">
            Please wait...
        </p>
    </div>
    @if (Model.IsNotNullOrEmpty())
    {
        string base64 = "";
        string QRImgSrc = "";
        string CUSRegistrationNo = "";

        foreach (var student in Model)
        {
            CUSRegistrationNo = student.CUSRegistrationNo + "".ToUpper();

            base64 = Convert.ToBase64String(student.QRCode);
            QRImgSrc = String.Format($"data:image/png" + ";base64,{0}", base64);
            student.Photograph = string.IsNullOrWhiteSpace(student.Photograph) ? "~/Content/ThemePublic/Libraries/images/team/administration/small/no-image.png" : student.Photograph;

            <div style="margin:0 auto;width:909px;padding:10px 10px">
                <div class="center">
                    <img src="/Content/ThemePublic/PrintImages/CUSLogo.png" style="width:90px;height:68px;" />
                    <img src="/Content/ThemePublic/Libraries/images/cus-logo1.svg" width="500" height="50" />
                    <br />
                    <strong style="font-size:20px;">
                        Semester-@student.Semester Exam [ADMIT CARD @student.year]
                        <img src="@QRImgSrc" class="QRCode" style="margin-left:70px;" />
                    </strong>
                </div>
                <table>
                    <tr>
                        <td colspan="3">
                            <strong style="float:left !important;">Exam Form No. : @student.FormNumber</strong>
                        </td>
                        <td colspan="2">
                            <strong style="float:right !important;font-size:17px;">Exam Roll No. : @student.ExamRollNumber</strong>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4">CUS Registration No.: @CUSRegistrationNo</td>
                        <td rowspan="5" class="center">
                            <img class="img-responsive" src="@Url.Content(student.Photograph)" width="150" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width:100px">Name</td>
                        <td>@student.FullName</td>
                        <td>Gender</td>
                        <td>@student.Gender</td>
                    </tr>
                    <tr>
                        <td>Father's Name</td>
                        <td colspan="3">@student.FathersName</td>

                    </tr>
                    <tr>
                        <td>Mobile</td>
                        <td>@student.PhoneNo</td>
                        <td>Batch</td>
                        <td>@student.Batch</td>
                    </tr>
                    @*<tr>
                            <td>Center</td>
                            <td colspan="3"><strong>@Model.AcceptCollegeID</strong></td>
                        </tr>*@
                    @if (!student.StudentSubjects.ToLower().Contains("-(reappear)"))
                    {
                        <tr>
                            <td>Course</td>
                            <th>@student.CourseFullName</th>
                            <td>Combination Code</td>
                            <th>@student.CombinationCode</th>
                        </tr>
                    }
                    else
                    {
                        <tr>
                            <td>Course</td>
                            <th colspan="3">@student.CourseFullName</th>
                        </tr>
                    }
                    <tr>
                        <td>Subjects</td>
                        <td colspan="4"><strong>@Html.Raw(student.StudentSubjects.Replace(" ,, ", "<br/>"))</strong></td>
                    </tr>
                </table>
                <h3>Examination Center @*&amp; Time*@</h3>
                <table>
                    <tr>
                        <th>Center Name &amp; Address</th>
                        <th>Center Number</th>
                        @*<th>Time</th>*@
                    </tr>
                    <tr>
                        <td><strong>@student.SemesterExamCenterDetail.CollegeFullName</strong> &nbsp; @student.SemesterExamCenterDetail.Address</td>
                        <td class="center"><strong>@student.SemesterExamCenterDetail.CenterCode</strong></td>
                        @*<td class="center">@AdmitCardDetails.Item5.Time</td>*@
                    </tr>
                </table>
                <div class="dontbreakInside" style="width:100% !important">
                    <p style="width:100%;text-align:justify">
                        <fieldset style="padding:0;">
                            <legend style="font-weight:bold;font-size:16px;color:red;text-align:center"> Important </legend>
                            <ol>
                                <li>In case of any variation in particulars, the candidate shall contact the I.T Section.</li>
                                <li>
                                    Those candidates who have not appeared/passed Internal/Continous assesment are not eligible to appear in Exam
                                    and their forms will be cancelled
                                </li>
                            </ol>
                        </fieldset>
                        <br /><br />
                        <span class="pull-left ">Printed on : @DateTime.UtcNow.ToLongDateString()</span>

                        <strong class="pull-right">
                            Signature of the Applicant
                        </strong>
                    </p>
                </div>
                <br />
            </div>


            <p class="breakpagehere"></p>
        }
    }
    else
    {
        <div class="parentdiv" style="font-size:18px;">
            No Record Found , reasons could be:<br />
            <ol>
                <li>Exam forms not submitted</li>
                <li>Exam RollNos not alloted yet</li>
                <li>Centers not alloted yet</li>
                <li>Internal Awards not submitted yet</li>
            </ol>
        </div>
    }

    <div class="noneOnPrint" style="margin-left:-14px;height:40px;background-color:lightslategrey;width:100%;position:fixed;bottom:0;z-index:100;text-align:center;padding-top:10px">
        <a style="height: 32px;color:white" href="https://www.wikihow.com/Save-a-Web-Page-as-a-PDF-in-Google-Chrome" target="_blank"><b>See How to Save as PDF</b></a>&nbsp;&nbsp;&nbsp;
        <button style="height: 32px;" href="#" class="btn btn-theme" onclick="window.print();"><b>Download or Print</b></button>
    </div>

    <script src="@Url.Content("~/Content/ThemeAdmin/Content/Scripts/Libraries/jquery-2.1.4.min.js")"></script>
    <script src="@Url.Content("~/Content/ThemePublic/Libraries/disableBack.js")"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#Jspleasewait").css("display", "none");
            $("body").removeClass("IsPrintbody");
        });
    </script>
</body>
</html>